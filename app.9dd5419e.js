"use strict";(self.webpackChunkf2e_2023_mission_2=self.webpackChunkf2e_2023_mission_2||[]).push([[143],{243:(t,e,n)=>{n.r(e);var a=n(827),r=n(216);let s,o,c;const l=function(t){s=t},i=function(t){o=t},d=function(t){c=t},u={year:function(){return s},city:function(){return o},dist:function(){return c}},p={toYear:function(t){document.getElementById("year").dataset.value=t},toCity:function(t){document.getElementById("city").dataset.value=t},toDist:function(t){document.getElementById("dist").dataset.value=t}};function m(){let t=0,e="";return function(n,a){return n>t&&(e=a,t=n),e}}const y=Object.keys(a);function h(){return Object.keys(a[s].縣市)}function v(){return Object.keys(a[s].縣市[o].鄉鎮市區)}function f(){return"全國"===o?a[s]:"全國"!=o&&"全部區域"===c?a[s].縣市[o]:"全部區域"!=c?a[s].縣市[o].鄉鎮市區[c]:void 0}function g(){return r[s]}const b={國民黨:"#8082FF",民進黨:"#57D2A9",無黨籍:"#CDCDCD",親民黨:"#F4A76F",新黨:"#F4D625",其他:"#9D9D9D","連署(1)":"#CDCDCD","連署(4)":"#986769"},L=[["1996",[["國民黨",5813699,54],["民進黨",2274586,21.13],["其他",2677834,24.88,[["連署(1)",1074044,9.98],["連署(4)",1603790,14.9]]]]],["2000",[["國民黨",2925513,23.1],["民進黨",4977697,39.3],["其他",4761183,37.6,[["連署(1)",4664972,36.84],["新黨",16782,.13],["連署(4)",79429,.63]]]]],["2004",[["國民黨",6442452,49.89],["民進黨",6471970,50.11],["其他",0,0]]],["2008",[["國民黨",7659014,58.44],["民進黨",5444949,41.55],["其他",0,0]]],["2012",[["國民黨",6891139,51.6],["民進黨",6093578,45.63],["無黨籍",369588,2.76]]],["2016",[["國民黨",3813365,31.04],["民進黨",6894744,56.12],["親民黨",1576861,12.83]]],["2020",[["國民黨",5522119,38.61],["民進黨",8170231,57.13],["親民黨",608590,4.26]]]],E=L.map((t=>t[0])),k=L[0][1].map((t=>t[0])),S=542,M=172,w="#DEE2E6",T="12px";function $(t){const e=document.createElement("div");return t.forEach((t=>{const n=document.createElement("div");n.setAttribute("data-party",t),n.style.background=b[t],e.appendChild(n)})),e.innerHTML}function q(t,e){const n=g(),a=document.querySelector("#area-list tbody"),r=document.querySelector("#area-list thead"),s=$(Object.keys(n)),o=u.city(),c=u.dist();let l,i=window.innerWidth;function d(){a.innerHTML="",r.innerHTML='\n            <tr>\n                <th style="min-width: 66px;">地區</th>\n                <th style="width: 75%;"></th>\n                <th></th>\n            </tr>\n        ',Object.keys(t).forEach((e=>{const r=t[e],o=document.createElement("tr");o.setAttribute("data-area",e),o.innerHTML=`\n                <td><h6>${e}</h6></td>\n                <td>\n                    <div class="td-elected">\n                        <span class="font-2">當選人</span>\n                        <div class="table-number"></div>\n                        <span></span>\n                    </div>\n                    <div class="proportion-bar">${s}</div>\n                </td>\n                <td class="td-arrow"></td>\n            `;const c=m();o.querySelectorAll(".proportion-bar div").forEach((t=>{const e=t.dataset.party;t.style.width=`${r[e].rate}%`,c(r[e].total,e)})),o.querySelector(".td-elected").style.marginBottom="8px",o.querySelector(".td-elected .table-number").innerHTML=n[c()].number,o.querySelector(".td-elected .table-number").style.background=b[c()],o.querySelector(".td-elected span:last-child").innerHTML=n[c()].name,a.appendChild(o)}))}function y(){a.innerHTML="",r.innerHTML='\n            <tr>\n                <th>地區</th>\n                <th style="width:25%">得票率</th>\n                <th>當選人</th>\n                <th>投票數</th>\n                <th>投票率</th>\n                <th></th>\n            </tr>\n        ',Object.keys(t).forEach((e=>{const r=t[e],o=document.createElement("tr");o.setAttribute("data-area",e),o.innerHTML=`\n                <td><h6>${e}</h6></td>\n                <td>\n                    <div class="proportion-bar">${s}</div>\n                </td>\n                <td class="td-elected">\n                    <div class="table-number"></div>\n                    <span></span>\n                </td>\n                <td>${r.total.toLocaleString()}</td>\n                <td>${r.rate}%</td>\n                <td class="td-arrow"></td>\n            `;const c=m();o.querySelectorAll(".proportion-bar div").forEach((t=>{const e=t.dataset.party;t.style.width=`${r[e].rate}%`,c(r[e].total,e)})),o.querySelector(".td-elected .table-number").innerHTML=n[c()].number,o.querySelector(".td-elected .table-number").style.background=b[c()],o.querySelector(".td-elected span").innerHTML=n[c()].name,a.appendChild(o)}))}"全國"===o?(document.querySelector(".area-votes h5").innerHTML="各縣市投票總覽",l=p.toCity):"全國"!=o&&"全部區域"===c?(document.querySelector(".area-votes h5").innerHTML="各鄉鎮市區投票總覽",l=p.toDist):"全部區域"!=c&&(document.querySelector(".area-votes h5").innerHTML="各村里投票總覽"),window.innerWidth>576?y():d(),window.addEventListener("resize",(()=>{i<=576&&window.innerWidth>576?y():i>576&&window.innerWidth<=576&&d(),i=window.innerWidth})),e?(a.style.cursor="pointer",a.querySelectorAll("tr").forEach((t=>{t.addEventListener("click",(t=>{l(t.currentTarget.dataset.area)}))}))):(a.style.cursor="auto",a.querySelectorAll(".td-arrow").forEach((t=>{t.classList.remove("td-arrow")})))}var A=n(161),H=n(780);const x=document.querySelector(".year-select .options"),C=document.querySelector(".city-select .options"),j=document.querySelector(".dist-select .options"),B=document.getElementById("year"),O=document.getElementById("city"),I=document.getElementById("dist");function D(t,e){t.forEach((t=>{const n=document.createElement("li");n.setAttribute("data-value",t),n.innerHTML=t,e.appendChild(n)}))}D(y,x);let N=!1;const z=new MutationObserver(((t,e)=>{t.forEach((t=>{if("attributes"===t.type&&"data-value"===t.attributeName){const e=t.target.getAttribute("data-value");B.innerHTML=e,l(e);const n=h();n.unshift("全國"),O.dataset.value=n[0],C.innerHTML="",D(n,C),function(){const t=g(),e=document.querySelector(".pres-votes .cand-list"),n=document.querySelector(".pres-votes .proportion-bar");e.innerHTML="",n.innerHTML="",Object.keys(t).forEach((n=>{const a=document.createElement("div");a.classList.add("cand"),a.setAttribute("data-party",n),a.innerHTML=`<div class="cand-number" style="background: ${b[n]};">${t[n].number}</div>\n                         <div class="cand-info">\n                             <small>${n}</small>\n                             <p class="font-1">${t[n].name}</p>\n                             <h6></h6>\n                             <span class="font-2">票</span>\n                         </div>`,e.appendChild(a)})),n.innerHTML=$(Object.keys(t))}(),N=!0}}))})),F=new MutationObserver(((t,e)=>{t.forEach((t=>{if("attributes"===t.type&&"data-value"===t.attributeName){const e=t.target.getAttribute("data-value");O.innerHTML=e,i(e);const n="全國"===e?[]:v();n.unshift("全部區域"),I.dataset.value=n[0],j.innerHTML="",D(n,j)}}))})),_=new MutationObserver(((t,e)=>{t.forEach((t=>{if("attributes"===t.type&&"data-value"===t.attributeName){const e=t.target.getAttribute("data-value");I.innerHTML=e,d(e),function(){let t=f();const e=u.city(),n=u.dist();"全國"===e?(document.querySelector("main h3").innerHTML="全臺縣市總統得票",q(t.縣市,!0),t=t.全國):"全國"!=e&&"全部區域"===n?(document.querySelector("main h3").innerHTML=`${e}總統得票`,q(t.鄉鎮市區,!0)):"全部區域"!=n&&(document.querySelector("main h3").innerHTML=`${e}${n}總統得票`,q(t.村里,!1));const a=t.rate;document.getElementById("total").innerHTML=t.total.toLocaleString(),document.getElementById("rate").innerHTML=`${a}%`,document.getElementById("valid").innerHTML=t.valid.toLocaleString(),document.getElementById("invalid").innerHTML=t.invalid.toLocaleString(),function(t){const e=Math.min(124,124)/2;d3.select("#donut-chart svg").remove();const n=d3.select("#donut-chart").append("svg").attr("width",124).attr("height",124).append("g").attr("transform","translate(62,62)"),a=d3.scaleOrdinal().range(["#E2E8F0","#D4009B"]),r=d3.pie().value((t=>t));n.selectAll().data(r(t)).join("path").attr("d",d3.arc().innerRadius(50).outerRadius(e)).attr("fill",(t=>a(t))),d3.select("#donut-voter-pct").html(`${t[1]}%`)}([100-a,a]);const r=document.querySelector(".pres-votes .cand-list"),s=m();r.querySelectorAll(".cand").forEach((e=>{const n=e.dataset.party;e.querySelector("h6").innerHTML=t[n].total.toLocaleString(),s(t[n].total,n)}));const o=r.querySelector(".elected");o&&o.classList.remove("elected"),r.querySelector(`.cand[data-party="${s()}"] p`).classList.add("elected"),document.querySelectorAll(".pres-votes .proportion-bar div").forEach((e=>{e.innerHTML="";const n=e.dataset.party,a=document.createElement("small");a.innerHTML=`${t[n].rate}%`,e.style.width=`${t[n].rate}%`,e.appendChild(a)}))}(),N&&(function(){const t=f().縣市,e=Object.keys(g());d3.selectAll("#map .island svg").remove(),d3.select("#map svg").remove();const n=d3.select("#map").append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 500 854"),a=n.append("g"),r=d3.geoMercator().center([121,24]).translate([266,330]).scale(13e3),s=d3.geoPath().projection(r),o=(0,A.Z)(H,H.objects.COUNTY_MOI_1090820);a.selectAll("path").data(o.features).join("path").attr("d",s).attr("class","city").on("click",(function(t,e){t.stopPropagation();const[[a,r],[o,l]]=s.bounds(e),[i,d]=s.centroid(e);n.transition().duration(750).call(c.transform,d3.zoomIdentity.translate(250,427).scale(500/(o-a)*.9).translate(-i,-d));const u=document.querySelector(".onclick");u&&u.classList.remove("onclick"),this.classList.add("onclick"),p.toCity(e.properties.COUNTYNAME)})).each((function(n){const a=n.properties.COUNTYNAME,r=t[a],s=m();r?(e.forEach((t=>{s(r[t].total,t)})),d3.select(this).attr("fill",b[s()])):d3.select(this).attr("fill","#FFF")})),a.selectAll().data(o.features).join("text").attr("transform",(t=>`translate(${s.centroid(t)})`)).attr("class","city-name").text((t=>t.properties.COUNTYNAME));const c=d3.zoom().scaleExtent([1,8]).translateExtent([[0,0],[500,854]]).on("zoom",(t=>{a.attr("transform",t.transform).style("font-size",`min(16px, ${24/t.transform.k}px)`)}));n.call(c),d3.select("#map .party-list").html("").selectAll().data(e).join("div").attr("class","dot").style("background",(t=>b[t])).each((function(t){const e=document.createElement("small");e.innerHTML=t,this.parentNode.insertBefore(e,this.nextSibling)})),document.querySelectorAll(".island object").forEach((n=>{const a=n.dataset.city,r=n.getSVGDocument(),s=t[a],o=m();e.forEach((t=>{o(s[t].total,t)})),r.querySelectorAll("svg path").forEach((t=>{t.setAttribute("fill",b[o()])})),r.querySelector("svg").addEventListener("click",(t=>{p.toCity(a)}))}))}(),N=!1)}}))})),P={attributes:!0,childList:!1,subtree:!1};z.observe(B,P),F.observe(O,P),_.observe(I,P),document.querySelectorAll(".select").forEach((t=>{const e=t.querySelector(".selected"),n=t.querySelector(".options");t.addEventListener("click",(e=>{e.stopPropagation();const n=document.querySelector(".active");n&&n!==t&&n.classList.remove("active"),t.classList.toggle("active")})),n.addEventListener("click",(t=>{"li"===t.target.tagName.toLowerCase()&&(e.dataset.value=t.target.dataset.value)}))})),document.addEventListener("click",(()=>{const t=document.querySelector(".active");t&&t.classList.remove("active")})),B.dataset.value="2020",function(){const t=d3.select("#bar-chart").append("svg").attr("width",602).attr("height",222).append("g").attr("transform","translate(60, 10)"),e=d3.scaleBand().domain(E).range([0,S]).paddingInner(.45).paddingOuter(.1);t.append("g").attr("transform","translate(0, 172)").call(d3.axisBottom(e).tickSize(0).tickPadding(10)).style("font-size",T).select(".domain").remove();const n=d3.format(".0f"),a=d3.scaleLinear().domain([0,1e7]).range([M,0]);t.append("g").call(d3.axisLeft(a).ticks(5).tickSize(-542).tickPadding(12).tickFormat((t=>0===t?"0":`${n(t/1e4)} 萬`))).call((t=>{t.select(".domain").remove(),t.selectAll("line").attr("stroke",w)})).style("font-size",T);const r=d3.scaleBand().domain(k).range([0,e.bandwidth()]).padding([.15]),s=d3.select("#bar-chart").append("div").attr("class","chart-info"),o=parseInt(s.style("width"),10);t.append("g").selectAll("g").data(L).join("g").attr("transform",(t=>"translate("+e(t[0])+", 0)")).attr("data-year",(t=>t[0])).selectAll("rect").data((t=>t[1])).join("rect").attr("x",((t,e)=>r(k[e]))).attr("y",(t=>a(t[1]))).attr("width",r.bandwidth()).attr("height",(t=>M-a(t[1]))).attr("fill",(t=>b[t[0]])).on("mouseover",(function(t,e){const n=d3.select(this.parentNode).attr("data-year"),a=d3.format(",");d3.select(this).style("opacity",.6),s.style("display","block").html(`<h6>${n} 年得票數</h6>`),"其他"===e[0]?e[3].forEach((t=>{s.append("div").html(`<div>\n                                    <div class="dot" style="background: ${b[t[0]]}"></div>\n                                    <span class='font-2'>${t[0]}</span>\n                                </div>\n                                <span class="font-2">${a(t[1])} 票</span>`)})):s.append("div").html(`<div>\n                            <div class="dot" style="background:${b[e[0]]}"></div>\n                            <span class="font-2">${e[0]}</span>\n                          </div>\n                          <span class="font-2">${a(e[1])} 票</span>`)})).on("mousemove",(function(t){s.style("top",t.clientY-90+"px").style("left",t.clientX+20+"px"),parseInt(s.style("right"),10)<0&&s.style("left",t.clientX-20-o+"px")})).on("mouseleave",(function(){s.style("display","none"),d3.select(this).style("opacity",1)})),d3.selectAll(".party-votes .party-list").selectAll().data(["國民黨","民進黨","無黨籍","親民黨","其他"]).join("div").attr("class","dot").style("background",(t=>b[t])).each((function(t){const e=document.createElement("small");e.innerHTML=t,this.parentNode.insertBefore(e,this.nextSibling)}))}(),function(){const t=d3.select("#line-chart").append("svg").attr("width",602).attr("height",222).append("g").attr("transform","translate(60, 10)"),e=d3.select("#line-chart").append("div").attr("class","chart-info"),n=parseInt(e.style("width"),10),a=function(t,n){e.style("display","block").html(`<h6>${n[0]} 年得票數</h6>`),n[1].forEach((t=>{"其他"===t[0]&&0!=t[2]?t[3].forEach((t=>{e.append("div").html(`<div>\n                                        <div class="dot" style="background: ${b[t[0]]}"></div>\n                                        <span class='font-2'>${t[0]}</span>\n                                    </div>\n                                    <span class="font-2">${t[2]} %</span>`)})):e.append("div").html(`<div>\n                                <div class="dot" style="background: ${b[t[0]]}"></div>\n                                <span class='font-2'>${t[0]}</span>\n                            </div>\n                            <span class="font-2">${t[2]} %</span>`)})),i.attr("opacity",1).attr("transform",`translate(${o.bandwidth()/2}, 0)`).attr("cx",o(n[0])).attr("cy",((t,e)=>l(n[1][e][2])))},r=function(t){e.style("top",t.clientY-140+"px").style("left",t.clientX+10+"px"),parseInt(e.style("right"),10)<0&&e.style("left",t.clientX-10-n+"px")},s=function(){e.style("display","none"),i.attr("opacity",0)},o=d3.scaleBand().domain(E).range([0,S]);t.append("g").attr("transform","translate(0, 172)").call(d3.axisBottom(o).tickSize(-172).tickPadding(10)).style("font-size",T).call((t=>{t.select(".domain").remove(),t.selectAll("line").attr("stroke","transparent").attr("stroke-width",o.bandwidth()).data(L).on("mouseover",a).on("mousemove",r).on("mouseleave",s)}));const c=d3.format(".0f"),l=d3.scaleLinear().domain([0,60]).range([M,0]);t.append("g").call(d3.axisLeft(l).ticks(6).tickSize(-542).tickPadding(12).tickFormat((t=>`${c(t)}%`))).style("font-size",T).call((t=>{t.select(".domain").remove(),t.selectAll("line").attr("stroke",w).style("pointer-events","none")})),t.selectAll().data(k).join("path").attr("fill","none").style("pointer-events","none").attr("stroke",(t=>b[t])).attr("stroke-width",2).attr("transform",`translate(${o.bandwidth()/2}, 0)`).attr("d",((t,e)=>d3.line().x((t=>o(t[0]))).y((t=>l(t[1][e][2])))(L)));const i=t.selectAll().data(k).join("circle").attr("r",4).attr("fill",(t=>b[t])).style("pointer-events","none").attr("opacity",0);d3.selectAll(".party-votes-pct .party-list").selectAll().data(k).join("div").attr("class","dot").style("background",(t=>b[t])).each((function(t){let e=document.createElement("small");e.innerHTML=t,this.parentNode.insertBefore(e,this.nextSibling)}))}()}}]);